(function(i,s){typeof exports=="object"&&typeof module<"u"?s(exports,require("deepmerge")):typeof define=="function"&&define.amd?define(["exports","deepmerge"],s):(i=typeof globalThis<"u"?globalThis:i||self,s(i.RevealPluginToolkit={},i.deepmerge))})(this,function(i,s){"use strict";var T=Object.defineProperty;var I=(i,s,n)=>s in i?T(i,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[s]=n;var f=(i,s,n)=>I(i,typeof s!="symbol"?s+"":s,n);var n=typeof document<"u"?document.currentScript:null;class m{constructor(e,l,o){f(this,"defaultConfig");f(this,"pluginInit");f(this,"pluginId");f(this,"mergedConfig",null);f(this,"data",{});typeof e=="string"?(this.pluginId=e,this.pluginInit=l,this.defaultConfig=o||{}):(this.pluginId=e.id,this.pluginInit=e.init,this.defaultConfig=e.defaultConfig||{})}initializeConfig(e){const l=this.defaultConfig,r=e.getConfig()[this.pluginId]||{};this.mergedConfig=s(l,r,{arrayMerge:(t,d)=>d,clone:!0})}getCurrentConfig(){if(!this.mergedConfig)throw new Error("Plugin configuration has not been initialized");return this.mergedConfig}getData(){return Object.keys(this.data).length>0?this.data:void 0}init(e){if(this.initializeConfig(e),this.pluginInit)return this.pluginInit(this,e,this.getCurrentConfig())}createInterface(e={}){return{id:this.pluginId,init:o=>this.init(o),getConfig:()=>this.getCurrentConfig(),getData:()=>this.getData(),...e}}}const C=a=>{const e=document.querySelector(`script[src$="${a}.js"], script[src$="${a}.min.js"], script[src$="${a}.mjs"]`);if(e!=null&&e.src){const l=e.getAttribute("src")||"",o=l.lastIndexOf("/");if(o!==-1)return l.substring(0,o+1)}try{if(typeof{url:typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:n&&n.tagName.toUpperCase()==="SCRIPT"&&n.src||new URL("plugintoolkit.js",document.baseURI).href}<"u"&&(typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:n&&n.tagName.toUpperCase()==="SCRIPT"&&n.src||new URL("plugintoolkit.js",document.baseURI).href))return(typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:n&&n.tagName.toUpperCase()==="SCRIPT"&&n.src||new URL("plugintoolkit.js",document.baseURI).href).slice(0,(typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:n&&n.tagName.toUpperCase()==="SCRIPT"&&n.src||new URL("plugintoolkit.js",document.baseURI).href).lastIndexOf("/")+1)}catch{}return`plugin/${a}/`},g="data-css-id",S=(a,e,l)=>new Promise((o,r)=>{const t=document.createElement("link");t.rel="stylesheet",t.href=e,t.setAttribute(g,a);const d=setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),l&&console.log(`[${a}] Timeout loading CSS from: ${e}`),r(new Error(`Timeout loading CSS from: ${e}`))},5e3);t.onload=()=>{clearTimeout(d),o()},t.onerror=()=>{clearTimeout(d),t.parentNode&&t.parentNode.removeChild(t),r(new Error(`Failed to load CSS from: ${e}`))},document.head.appendChild(t)}),$=a=>document.querySelectorAll(`[${g}="${a}"]`).length>0,y=async a=>{const{id:e,cssautoload:l=!0,csspath:o="",debug:r=!1}=a;if(l===!1||o===!1)return;if($(e)){r&&console.log(`[${e}] CSS already loaded, skipping`);return}const t=[];typeof o=="string"&&o.trim()!==""&&(t.push(o),r&&console.log(`[${e}] Added user-specified path: ${o}`));const d=C(e);if(d){const u=`${d}${e}.css`;t.push(u),r&&console.log(`[${e}] Added auto-detected path from script location: ${u}`)}const p=`plugin/${e}/${e}.css`;t.push(p),r&&console.log(`[${e}] Added standard fallback path: ${p}`);const h=`plugins/${e}/${e}.css`;t.push(h),r&&console.log(`[${e}] Added standard fallback path: ${h}`);for(const u of t)try{r&&console.log(`[${e}] Trying CSS path: ${u}`),await S(e,u,r);let c="CSS";o&&u===o?c="user-specified CSS":d&&u===`${d}${e}.css`?c="auto-detected script location CSS":c="standard fallback CSS",r&&console.log(`[${e}] ${c} loaded successfully from: ${u}`);return}catch{r&&console.log(`[${e}] Failed to load CSS from: ${u}`)}console.warn(`[${e}] Could not load CSS from any location`)};i.PluginBase=m,i.pluginCSS=y,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
